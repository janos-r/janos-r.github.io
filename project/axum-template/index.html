<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=generator content="Source Themes Academic 4.8.0">
<meta name=author content="Radim Janoš">
<meta name=description content="Web API with Axum server, Graphql and SurrealDB">
<link rel=alternate hreflang=cs href=/cs/project/axum-template/>
<link rel=alternate hreflang=ja href=/ja/project/axum-template/>
<link rel=alternate hreflang=en-us href=/project/axum-template/>
<meta name=theme-color content="#2962ff">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/github.min.css crossorigin=anonymous title=hl-light>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous>
<script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
<link rel=stylesheet href=/css/academic.css>
<link rel=manifest href=/index.webmanifest>
<link rel=icon type=image/png href=/images/icon_hub89e7b28a6abff2b4ec084e6c0608a00_13774_32x32_fill_lanczos_center_3.png>
<link rel=apple-touch-icon type=image/png href=/images/icon_hub89e7b28a6abff2b4ec084e6c0608a00_13774_192x192_fill_lanczos_center_3.png>
<link rel=canonical href=/project/axum-template/>
<meta property="twitter:card" content="summary_large_image">
<meta property="og:site_name" content="Radim">
<meta property="og:url" content="/project/axum-template/">
<meta property="og:title" content="Axum Template | Radim">
<meta property="og:description" content="Web API with Axum server, Graphql and SurrealDB"><meta property="og:image" content="/project/axum-template/featured.png">
<meta property="twitter:image" content="/project/axum-template/featured.png"><meta property="og:locale" content="en-us">
<meta property="article:published_time" content="2023-06-14T00:00:00+00:00">
<meta property="article:modified_time" content="2023-06-14T00:00:00+00:00">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"/project/axum-template/"},"headline":"Axum Template","image":["/project/axum-template/featured.png"],"datePublished":"2023-06-14T00:00:00Z","dateModified":"2023-06-14T00:00:00Z","author":{"@type":"Person","name":"Radim Janoš"},"publisher":{"@type":"Organization","name":"Radim","logo":{"@type":"ImageObject","url":"/images/icon_hub89e7b28a6abff2b4ec084e6c0608a00_13774_192x192_fill_lanczos_center_3.png"}},"description":"Web API with Axum server, Graphql and SurrealDB"}</script>
<title>Axum Template | Radim</title>
</head>
<body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents>
<aside class=search-results id=search>
<div class=container>
<section class=search-header>
<div class="row no-gutters justify-content-between mb-3">
<div class=col-6>
<h1>Search</h1>
</div>
<div class="col-6 col-search-close">
<a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a>
</div>
</div>
<div id=search-box>
<input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control>
</div>
</section>
<section class=section-search-results>
<div id=search-hits>
</div>
</section>
</div>
</aside>
<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main>
<div class=container>
<div class="d-none d-lg-inline-flex">
<a class=navbar-brand href=/>Radim</a>
</div>
<button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span>
</button>
<div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
<a class=navbar-brand href=/>Radim</a>
</div>
<div class="navbar-collapse main-menu-item collapse justify-content-end" id=navbar-content>
<ul class="navbar-nav d-md-inline-flex">
<li class=nav-item>
<a class=nav-link href=/#about><span>About</span></a>
</li>
<li class=nav-item>
<a class=nav-link href=/#skills_lang><span>Skills</span></a>
</li>
<li class=nav-item>
<a class=nav-link href=/#experience><span>Experience</span></a>
</li>
<li class=nav-item>
<a class=nav-link href=/#projects><span>Projects</span></a>
</li>
<li class=nav-item>
<a class=nav-link href=/#contact><span>Contact</span></a>
</li>
</ul>
</div>
<ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
<li class=nav-item>
<a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a>
</li>
<li class="nav-item dropdown theme-dropdown">
<a href=# class="nav-link js-theme-selector" data-toggle=dropdown aria-haspopup=true>
<i class="fas fa-palette" aria-hidden=true></i>
</a>
<div class=dropdown-menu>
<a href=# class="dropdown-item js-set-theme-light">
<span>Light</span>
</a>
<a href=# class="dropdown-item js-set-theme-dark">
<span>Dark</span>
</a>
<a href=# class="dropdown-item js-set-theme-auto">
<span>Automatic</span>
</a>
</div>
</li>
<li class="nav-item dropdown i18n-dropdown">
<a href=# class=nav-link data-toggle=dropdown aria-haspopup=true>
<i class="fas fa-globe mr-1" aria-hidden=true></i></a>
<div class=dropdown-menu>
<div class="dropdown-item dropdown-item-active">
<span>English</span>
</div>
<a class=dropdown-item href=/cs/project/axum-template/>
<span>Česky</span>
</a>
<a class=dropdown-item href=/ja/project/axum-template/>
<span>日本語</span>
</a>
</div>
</li>
</ul>
</div>
</nav>
<article class="article article-project">
<div class="article-container pt-3">
<h1>Axum Template</h1>
<div class=article-metadata>
<span class=article-date>
14 June 2023
</span>
</div>
<div class="btn-links mb-3">
<a class="btn btn-outline-primary my-1 mr-1" href=https://github.com/janos-r/axum-template target=_blank rel=noopener>
<i class="fab fa-github mr-1"></i>
Project on GitHub
</a>
</div>
</div>
<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:452px>
<div style=position:relative>
<img src=/project/axum-template/featured_hu565907f786c486dd65dff34948c40ed1_583164_720x0_resize_lanczos_3.png alt class=featured-image>
</div>
</div>
<div class=article-container>
<div class=article-style>
<h1 id=web-api-rust-stack>Web API Rust stack</h1>
<p>This project is heavily inspired by the brilliant
<a href="https://www.youtube.com/watch?v=XZtlD_m59sM" target=_blank rel=noopener>video</a> from Jeremy Chone. Parts of the code are exactly the same. I simply followed the tutorial, adjusted some preferences and later decided to add GraphQL and SurrealDB. Hope this can be helpful to somebody. Also please let me know if you have any suggestions for optimizing the code, especially in the areas where I mention that I am not decided what would be the best implementation, like the surrealDb IDs.</p>
<h2 id=project-structure>Project structure</h2>
<ul>
<li>rest and gql routes</li>
<li>services that can resolve both, because they use the same Result type
<ul>
<li>resolution of the ApiResult is handled separately by the impls for rest and gql</li>
</ul>
</li>
</ul>
<pre><code> └─┬ src
   ├─┬ graphql
   │ ├─┬ query_root
   │ │ ├── tickets_query.rs
   │ │ └── tickets_no_db_query.rs
   │ ├─┬ mutation_root
   │ │ ├── tickets_no_db_mutation.rs
   │ │ └── tickets_mutation.rs
   │ ├── query_root.rs
   │ └── mutation_root.rs
   ├─┬ web
   │ ├── routes_tickets_no_db.rs
   │ ├── routes_tickets.rs
   │ ├── routes_login.rs
   │ └── routes_hello.rs
   ├─┬ service
   │ ├── ticket_no_db.rs
   │ └── ticket.rs
   ├── error.rs
   ├── web.rs
   ├── service.rs
   ├── mw_req_logger.rs
   ├── mw_ctx.rs
   ├── main.rs
   ├── graphql.rs
   └── ctx.rs
</code></pre>
<h1 id=error-handling>Error handling</h1>
<h2 id=goals>Goals</h2>
<ul>
<li>Control over the display of errors to the client, and the debug log of errors on the server</li>
<li>Presenting errors to the client with the request id, and logging all request ids and occurred errors raw (debug) on the server</li>
</ul>
<h2 id=why-no-error-crate>Why no error crate?</h2>
<p>I don&rsquo;t use Anyhow or Thiserror here. I think it is clearer what is happening in the code and easier to maintain with simply writing the Display and From traits myself. It is possible the same results could be achieved with using Thiserror and having possibly fewer lines of code, but that is not worth the extra crate logic for me.<br>
I might change my opinion on this in the future. But I see other project using even both of these crates at the same time. I simply think that using rust traits as they are is clearer. Clearer and more maintainable long-term, than adding an ever increasing number of 3rd party crates, locking down the code, with good intentions of simplifying error handling, but possibly (likely?) making it more complicated. Just impl the trait, its not so hard.</p>
<h2 id=undecided>Undecided</h2>
<p>If all <code>req_id</code> should always be presented to the client and how. Currently I&rsquo;m leaning to the more conservative approach to present them only with errors. But presenting them always would open the possibility to get rid of the ApiError wrapper.</p>
<pre><code class=language-rust>// error.rs
pub struct ApiError {
    pub error: Error,
    pub req_id: Uuid,
}
pub enum Error {
    Generic { description: String },
    LoginFail,
    ...
}
pub type ApiResult&lt;T&gt; = core::result::Result&lt;T, ApiError&gt;;
pub type Result&lt;T&gt; = core::result::Result&lt;T, Error&gt;;

</code></pre>
<h2 id=apierror>ApiError</h2>
<h3 id=original-purpose>Original purpose</h3>
<p>If errors should include their <code>req_id</code>, it should be part of the error body. But if every error variant has to have it, its maybe better to wrap them all with this higher Error that always has it.</p>
<h3 id=pros>pros</h3>
<ul>
<li>Type enforced resolution into this type, not just to any that implements Display that satisfies the gql result.</li>
</ul>
<h3 id=cons>cons</h3>
<ul>
<li>Another abstraction layer, very unfortunate if it would not be necessary</li>
<li>Impossible to use a simple into (?) from ocurred errors to ApiError, because it requires additional information from the context (<code>req_id</code>). Requiring an explicit <code>.map_err</code> at the end of every service function (not elegant).</li>
</ul>
<pre><code class=language-rust>// service/ticket.rs
pub async fn list_tickets(&amp;self) -&gt; ApiResult&lt;Vec&lt;Ticket&gt;&gt; {
    self.db
        .select(&quot;tickets&quot;)
        .await
        .map_err(ApiError::from(self.ctx)) // From DB error, displaying a generic message, logging the source
}
pub async fn delete_ticket(&amp;self, id: String) -&gt; ApiResult&lt;Ticket&gt; {
    self.db
        .delete((&quot;tickets&quot;, &amp;id))
        .await
        .map_err(|e| ApiError { // an error picked on the spot
            req_id: self.ctx.req_id(),
            error: Error::SurrealDbNoResult {
                source: e.to_string(),
                id,
            },
        })
}
</code></pre>
<h2 id=if-no-apierror-only-one-single-crate-enum-error>If no ApiError (only one single crate enum Error)</h2>
<h3 id=pros-1>pros</h3>
<ul>
<li>One less abstraction layer for the Errors</li>
</ul>
<h3 id=cons-1>cons</h3>
<ul>
<li>Req_id would have to be returned always, in http header and gql body extension. Or another step would have to be introduced that filters responses with Errors, which is probably even more convoluted than the current ApiError solution.</li>
<li>From Error for gqlError is implemented automatically in the library, so its not possible to do it manually. The way how the library author intended extending errors (so I can save the raw error for the logger), is to implement <code>ErrorExtensions</code> for the enum Error. That is still not part of the into, it will still not be used with (?), it has to be still called every time on the error with <code>.extend()</code> making it very similar to the current &ldquo;non elegant&rdquo; mapping. Difference is that now the mapping is called on the end of the service when ApiError is created, but the <code>.extend()</code> would be called only at the end of the gql route, when the gql result is created.</li>
</ul>
<h2 id=apierror-conclusion>ApiError conclusion</h2>
<p>If I would use <code>ErrorExtensions</code> and <code>.extend()</code>, it would not be a big progress and it would loose me the control of optionally not showing the <code>req_id</code> to the client. That could include future data connected to all errors that should not always be returned. Therefore I will keep this structure.
But if I would know that adding the <code>req_id</code> in every single response always is a good idea, I can see it would be better to use only one simple Error type, with the added risk of not having it type-checked if you would forget to add <code>.extend()</code> at every response, not logging the error on the server.</p>
<h1 id=logging>Logging</h1>
<p>I use the same idea from Jeremy Chone&rsquo;s video. To build the response using the client-facing data in the error. Than saving the raw error using axum&rsquo;s (http) response extensions, and extracting it back out for logging in one dedicated middleware layer <code>mw_req_logger</code> for the server. This way, every single request has exactly one dedicated log, that can also include errors and further details.<br>
I wanted to adhere to this even with the gql addition.</p>
<p>To achieve this with Gql, I couldn&rsquo;t simply use <code>impl IntoResponse for ApiError</code> as the rest routes are using, because the response is build by the Gql library. I had to find a way how to give the ApiError to gql, and later add it to the response extensions, so it gets picked up in the end the same way as the rest responses in the <code>mw_req_logger</code>.</p>
<p>Because ApiError doesn&rsquo;t implement Display, it does not have an automatic From impl for <code>async_graphql::Error</code>. By writing it manually, I can in the same step store the raw error in serialized json inside the gql response structure under &ldquo;error extensions&rdquo;.</p>
<pre><code class=language-rust>// error.rs
impl From&lt;ApiError&gt; for async_graphql::Error {
    fn from(value: ApiError) -&gt; Self {
        Self::new(value.error.to_string())
            .extend_with(|_, e| e.set(&quot;req_id&quot;, value.req_id.to_string()))
            // storing the original as json in the error extension - for the logger
            .extend_with(|_, e| e.set(ERROR_SER_KEY, serde_json::to_string(&amp;value.error).unwrap()))
    }
}
</code></pre>
<p>After the gql response is built, just before it is handed over to it&rsquo;s axum <code>IntoResponse</code> in the <code>graphql_handler</code>, I extract the error, deserialized it, than turn it into the axum response with <code>IntoResponse</code> and than I can store the extracted Error in the request extensions just like with the rest errors.</p>
<pre><code class=language-rust>// graphql.rs
pub async fn graphql_handler(
    schema: Extension&lt;ApiSchema&gt;,
    ctx: Ctx,
    req: async_graphql_axum::GraphQLRequest,
) -&gt; axum::response::Response {
    let mut gql_resp: async_graphql::Response = schema.execute(req.into_inner().data(ctx)).await;

    // Remove error extensions and deserialize errors
    let mut error: Option&lt;Error&gt; = None;
    for gql_error in &amp;mut gql_resp.errors {
        let Some(extensions) = &amp;mut gql_error.extensions else { continue };
        let Some(value) = extensions.get(ERROR_SER_KEY) else { continue };
        let Value::String(s) = value else { continue };
        error = Some(serde_json::from_str(s).unwrap_or_else(Error::from));
        extensions.unset(ERROR_SER_KEY);
        break;
    }
    let mut response = async_graphql_axum::GraphQLResponse::from(gql_resp).into_response();
    // Insert the real Error into the response - for the logger
    if let Some(e) = error {
        response.extensions_mut().insert(e);
    }
    response
}
</code></pre>
<p>I understand that this serde step is not ideal, but for now I don&rsquo;t have a better solution and this works.</p>
<h1 id=gql-and-db-integration>Gql and DB integration</h1>
<p>I am very happy with this.</p>
<p>In my previous company project, where we used MongoDb with Mongoose, Apollo Gql and TypeScript, to provide a table to gql, 4 different implementations of the type were used.</p>
<ol>
<li>The Gql schema</li>
<li>The DB model schema</li>
<li>The TS type derived from the model - used for manipulation</li>
<li>A &ldquo;plain&rdquo; version of the type, without the id and all of the mongoose methods and metadata - used for arguments and returns of just the data</li>
</ol>
<p>I expected something similar, but thanks to rust having such a strong type system, allot of this is baked in. For simple objects, it is enough to have just one type.
This is incredibly simple to look at, as easy (if not easier) to set up and use as rest, and fully type safe, with all the other gql benefits.</p>
<p>This is the gql route, it resolves in the <code>.list_tickets()</code> function that is visible in the firs snippet on this page.</p>
<pre><code class=language-rust>// graphql/query_root/tickets_query.rs
impl TicketsQuery {
    async fn list(&amp;self, ctx: &amp;Context&lt;'_&gt;) -&gt; Result&lt;Vec&lt;Ticket&gt;&gt; {
        let db = ctx.data::&lt;Db&gt;()?;
        let ctx = ctx.data::&lt;Ctx&gt;()?;
        Ok(TicketService { db, ctx }.list_tickets().await?)
    }
}
</code></pre>
<p>And this is the whole Ticket implementation. DB model, Gql schema and data type in one.</p>
<pre><code class=language-rust>// service/tickets.rs
#[derive(Clone, Debug, Serialize, Deserialize, SimpleObject)]
#[graphql(complex)]
pub struct Ticket {
    #[graphql(skip)]
    pub id: Option&lt;Thing&gt;,
    pub creator_id: u64,
    pub title: String,
}
#[ComplexObject]
impl Ticket {
    async fn id(&amp;self) -&gt; String {
        self.id.as_ref().map(|t| &amp;t.id).expect(&quot;id&quot;).to_raw()
    }
}
</code></pre>
<p>The same struct can be used for creating the model with a random ID, because it is set as Option. It is possible to manually create a random Id, but I like this much better.</p>
<pre><code class=language-rust>pub async fn create_ticket(&amp;self, ct_input: CreateTicketInput) -&gt; ApiResult&lt;Ticket&gt; {
    self.db
        .create(&quot;tickets&quot;)
        .content(Ticket {
            id: None,
            creator_id: self.ctx.user_id()?,
            title: ct_input.title,
        })
        .await
        .map_err(ApiError::from(self.ctx))
}
</code></pre>
<h2 id=surrealdb-ids>SurrealDb Ids</h2>
<h3 id=undecided-1>Undecided</h3>
<p>The Id in surreal DB has the format <code>table:id</code>. In the surrealdb library this is called a <code>Thing</code>. This has advantages and disadvantages.
I am not sure where I should use the full &ldquo;Thing format&rdquo;, and where just the wrapped <code>id</code>.</p>
<h3 id=hiding-the-table-name>Hiding the table name</h3>
<h3 id=pros-2>pros</h3>
<ul>
<li>Doesn&rsquo;t unnecessarily expose the table name.</li>
<li>Prevents mistaken &ldquo;injection&rdquo; where you access a record from another table</li>
<li>Slightly better resource access. The tuple resource <code>.delete((table, id))</code> is also how the docs recommend it. Thing format has to be first parsed with <code>thing()</code> and handled.</li>
</ul>
<h3 id=cons-2>cons</h3>
<ul>
<li>Extracting the table from the DB result</li>
</ul>
<p>In order to cover both gql and rest results, the mapping would have to be done for every result on the service level.
Alternatively a gql scalar type could achieve this, but only for gql. With a new-type pattern <code>WThing(Thing)</code> and a gql macro
<a href=https://async-graphql.github.io/async-graphql/en/custom_scalars.html target=_blank rel=noopener>#[Scalar]</a> for generating the scalar. Returning just the id in <code>to_value</code> should work, but It would not make sense to than expect the full format in <code>parse</code>. This part of the Trait would have to be left unimplemented, since we don&rsquo;t want the full Id on the input.</p>
<p>I am not sure what the right decision here should be. But I think that the returned ids should have the same format as the expected input ids once decided.</p>
<h2 id=conclusion>Conclusion</h2>
<p>In conclusion, Axum is very advanced and does seam ready for serious use. The same can be said about async_graphql, even though Im using it for slightly unorthodox experiments in this project (the error json juggling). I really wanted to try SurrealDb and this is hopefully not the last time Im trying it out. At least the versioning suggests that a v1.0 is right around the corner and hopefully its usage will get more standardized, the docs could be a little expanded and I believe it will get further attention in the future.
A nice project. I didn&rsquo;t encounter any strong deal-breakers. But un-surprisingly there are open questions regarding best-practices in such a new experimental Axum, Gql, Surreal, Rust Web Stack.</p>
</div>
<div class=article-tags>
<a class="badge badge-light" href=/tag/code/>Code</a>
<a class="badge badge-light" href=/tag/rust/>Rust</a>
</div>
<div class="media author-card content-widget-hr">
<img class="avatar mr-3 avatar-circle" src=/author/radim-janos/avatar_hu64d921ec107bff3d62a3fb75542fa15a_49188_270x270_fill_q90_lanczos_center.jpg alt="Radim Janoš">
<div class=media-body>
<h5 class=card-title><a href=/>Radim Janoš</a></h5>
<h6 class=card-subtitle>Developer</h6>
<ul class=network-icon aria-hidden=true>
<li>
<a href=/#contact>
<i class="fas fa-envelope"></i>
</a>
</li>
<li>
<a href=https://github.com/janos-r target=_blank rel=noopener>
<i class="fab fa-github"></i>
</a>
</li>
<li>
<a href=/files/CV_Radim_Janos-%28en%29.pdf>
<i class="ai ai-cv"></i>
</a>
</li>
</ul>
</div>
</div>
<div class="article-widget content-widget-hr">
<h3>Related</h3>
<ul>
<li><a href=/project/rusty_woods/>Rusty Woods</a></li>
<li><a href=/project/agent_tag_bevy/>Game engine</a></li>
<li><a href=/project/agent_tag/>Agent based simulation modeling</a></li>
<li><a href=/project/yewban/>Yewban</a></li>
<li><a href=/project/exercism/>Exercism.io</a></li>
</ul>
</div>
<div class="project-related-pages content-widget-hr">
</div>
</div>
</article>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/highlight.min.js integrity="sha512-7t8APmYpzEsZP7CYoA7RfMPV9Bb+PJHa9x2WiUnDXZx3XHveuyWUtvNOexhkierl5flZ3tr92dP1mMS+SGlD+A==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/languages/r.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script>
<script>const code_highlighting=!0</script>
<script>const isSiteThemeDark=!1</script>
<script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks",slides:"Slides"}</script>
<script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script>
<script src=/js/academic.min.f6ecf7692215f2bc4850b72c8176bfa2.js></script>
<div class=container>
<footer class=site-footer>
<p class=powered-by>
<span class=float-right aria-hidden=true>
<a href=# class=back-to-top>
<span class=button_icon>
<i class="fas fa-chevron-up fa-2x"></i>
</span>
</a>
</span>
</p>
</footer>
</div>
<div id=modal class="modal fade" role=dialog>
<div class=modal-dialog>
<div class=modal-content>
<div class=modal-header>
<h5 class=modal-title>Cite</h5>
<button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span>
</button>
</div>
<div class=modal-body>
<pre><code class="tex hljs"></code></pre>
</div>
<div class=modal-footer>
<a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank>
<i class="fas fa-copy"></i> Copy
</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank>
<i class="fas fa-download"></i> Download
</a>
<div id=modal-error></div>
</div>
</div>
</div>
</div>
</body>
</html>